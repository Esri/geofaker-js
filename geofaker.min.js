/*! geofaker - v0.1.1 - 2013-11-19
*   https://github.com/Esri/geofaker-js
*   Copyright (c) 2013 Environmental Systems Research Institute, Inc.
*   Apache 2.0 License */

!function(a){function b(){}function c(a){if(!a.clientId)throw new Error("missing clientId");return this.clientId=a.clientId,this.session=new Geotrigger.Session({clientId:this.clientId}),this._sendQueue=[],this}function d(a){return"[object Object]"===Object.prototype.toString.call(a)}function e(a){return"[object Array]"===Object.prototype.toString.call(a)}function f(a){var b=[];if(d(a))b.push(g(a));else if(e(a)&&d(a[0]))for(var c=0;c<a.length;c++)b.push(g(a[c]));else{if(!e(a)||2!==a.length||isNaN(a[0])||isNaN(a[1]))throw new Error("invalid location options");b.push(g({latitude:a[0],longitude:a[1]}))}return b}function g(a){for(var b in i.locationObject)if(i.locationObject.hasOwnProperty(b)){if(b in a)continue;a[b]=i.locationObject[b]}if("undefined"==typeof a.timestamp){var c=new Date;a.timestamp=c.toISOString()}return a}function h(a,c){c="function"==typeof c?c:b,this.session.queue(function(){this.request("location/update",a,c)})}Date.prototype.toISOString||!function(){function a(a){var b=String(a);return 1===b.length&&(b="0"+b),b}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}();var i={};i.locationObject={accuracy:10,trackingProfile:"adaptive"},c.prototype.setTags=function(a,c){c="function"==typeof c?c:b;var d={setTags:a};return this.session.queue(function(){this.request("device/update",d,c)}),this},c.prototype.send=function(a,b){var c=f(a);return h.apply(this,[{locations:c},b]),this},a.Geofaker=c}(window);